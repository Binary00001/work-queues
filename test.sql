-- INSERT INTO dbo.AgcmTable (AGPO, AGITEM, AGPART, AGRUN, AGPMCOMMENTS, AGCPEXP) 
-- VALUES



-- UPDATE dbo.AgcmTable SET AGPMCOMMENTS = 'BURNDOWN ETRAC(9/30)' 
-- WHERE AGPO = '621001176497'
-- AND AGITEM = 13
-- AND AGRUN =  83
-- ;

-- SELECT 
--      (SELECT COUNT(OPREF) FROM RnopTable 
--         INNER JOIN RunsTable ON RUNREF = OPREF 
--         AND RUNNO = OPRUN 
--         WHERE RUNPKPURGED = 0 
--         AND RTRIM(OPINSP) = 'KEITH STONE'
--         AND OPCOMPDATE >= CAST(GETDATE() AS DATE)
--         GROUP BY OPCENTER) AS completed_jobs 
--       ;


SELECT PART_NUMBER, RUN, PO, RTRIM(LTRIM(ITEM)) AS ITEM, DAYS_IN_QUEUE, CUSTOMER, PRIORITY, COMMENTS, EXPEDITE, CUST_REQ_DATE, RUN_QTY, WORK_CENTER, WC, t2.WCNDESC as WC_NAME
      FROM dbo.QueueInfo WITH (nolock)
      INNER JOIN WcntTable AS t2 ON WC = t2.WCNNUM
         WHERE WC = '2060'
         AND SUBSTRING(COMMENTS, 1, 8) = 'BURNDOWN'
         ORDER BY CUST_REQ_DATE ASC;

-- select top 10 * from AgwoTable;

-- select top 10 * from dbo.QueueInfo; 

-- SELECT * FROM AgcmTable WHERE AGPO = '613000529984';


-- DELETE FROM dbo.AgcmTable WHERE AGPO='613000524555' AND AGRUN=10;

--  SELECT 
--     (SELECT COUNT(OPREF) FROM RnopTable 
--        INNER JOIN RunsTable ON RUNREF = OPREF 
--        AND RUNNO = OPRUN 
--        WHERE RUNPKPURGED = 0 
--        AND OPCOMPDATE >= CAST(GETDATE() AS DATE)
--        GROUP BY OPCENTER) AS completed_jobs, 
--      (SELECT COUNT(OPREF) FROM RnopTable 
--        WHERE OPCOMPLETE = 0 
--        AND OPSCHEDDATE <= CAST(GETDATE() as DATETIME) + 30
--        GROUP BY OPCENTER) AS daily_goal, OPCENTER FROM RnopTable GROUP BY OPCENTER;
 
-- SELECT COUNT(OPREF) as completed FROM dbo.RnopTable 
--     INNER JOIN RunsTable ON RUNREF = OPREF AND RUNNO = OPRUN 
--     WHERE RUNPKPURGED = 0 
--     AND OPCENTER = '1600'
--     AND OPCOMPDATE >= CAST(GETDATE() AS DATE)

--     GROUP BY OPCENTER;
-- SELECT rt.RUNREF, rt.RUNNO, rt.RUNCOMPLETE, rt.RUNQTY, rt.RUNOPCUR, rt.RUNPRIORITY, rt.RUNRTNUM, rnop.OPCENTER, rnop.OPCOMPDATE, rnop.OPINSP
-- FROM dbo.RunsTable as rt
-- LEFT JOIN dbo.RnopTable AS rnop ON rt.RUNREF = rnop.OPREF AND rt.RUNNO = rnop.OPRUN
-- ORDER BY ;



